<!DOCTYPE html>
<html class="scroll-nice">
<head>
	<title>Emotion Music</title>

	<link href="main.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/css/materialize.min.css">
</head>
<body style="background: #130B17; overflow-x: hidden; overflow-y: scroll;">

	<canvas id="canvas" onmousemove="mousePosition(event)" style="height: 100%;"></canvas>

	<div style="background: #130B17; height: 600px;">
		
	</div>

</body>

	<script>

var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");
var width = canvas.width;
var height = canvas.height;
var circles = [];
var xp = 0;
var yp = 0;

function mousePosition(e) {
	xp = e.clientX;
	yp = e.clientY + window.pageYOffset;
	getHover();
}

function getHover() {
	for (var i = 0; i < circles.length; i++) {
		if (Math.pow(Math.pow((xp - circles[i].x + circles[i].xs), 2) + Math.pow((yp - circles[i].y + circles[i].ys), 2), .5) < circles[i].rad + circles[i].radex) {
			circles[i].hover = 1;
		} else {
			circles[i].hover = 0;
		}
	}
}

class Circle {
	constructor(x, y, rad, r, g, b) {
		this.x = x;
		this.y = y;

		this.rad = rad;
		this.radex = 0;
		this.hover = 0;

		this.r = r;
		this.g = g;
		this.b = b;

		this.s = 0;
		this.xs = 0;
		this.ys = 0;
		this.xm = Math.random() * .01;
		this.ym = Math.random() * .01;
		this.xa = Math.random() * 2 + 4 + this.rad * .05;
		this.ya = Math.random() * 2 + 4 + this.rad * .05;
	}

	calcPos() {
		this.xs = Math.sin(this.s * this.xm) * this.xa;
		this.ys = Math.sin(this.s * this.ym) * this.ya;
		this.s++;
		if (!this.s % 1500) {
			this.s = 0;
			this.xm = Math.random() * .025;
			this.ym = Math.random() * .025;
			this.xa = Math.random() * 2 + 4 + this.rad * .05;
			this.ya = Math.random() * 2 + 4 + this.rad * .05;
		}

		if (this.hover && this.radex < this.rad * .2) {
			this.radex++;
		} else if (!this.hover && this.radex > 0) {
			this.radex--;
		}
	}

	draw(a) {
		this.calcPos();
		ctx.beginPath();

		var grd = ctx.createLinearGradient(this.x - this.rad, this.y - this.rad, this.x + this.rad, this.y + 10);
		grd.addColorStop(0, "rgba(" + (this.r + 30) + "," + (this.g + 30) + "," + (this.b + 30) + "," + a + ")");
		grd.addColorStop(1, "rgba(" + this.r + "," + this.g + "," + this.b + "," + a + ")");
		ctx.fillStyle = grd;

		// ctx.fillStyle = "rgba(" + this.r + "," + this.g + "," + this.b + "," + a + ")";
		ctx.strokeStyle = "#111111";
		// ctx.lineWidth = 10;
		ctx.arc(this.x + this.xs, this.y + this.ys, this.rad + this.radex, 0, 2 * Math.PI);
		ctx.fill();
		// ctx.stroke();
		ctx.closePath();
	}
}

function init() {
	for (var i = 0; i < 7; i++) {
		var brightness = Math.random() * 60;
		circles.push(new Circle(Math.random() * (width - 200) + 100, Math.random() * (height - 200) + 100, Math.random() * window.innerWidth / 27 + window.innerWidth / 27, Math.random() * 7 + 60 + brightness, Math.random() * 7 + 60 + brightness, Math.random() * 7 + 60 + brightness));
	}
}

function getOpacityOverlay() {
	if (window.pageYOffset < window.innerHeight) {
		return 3.2 * Math.pow(window.pageYOffset / window.innerHeight, 3);
	}
	return 1;
}

function update() {
	if (canvas.width != window.innerWidth || canvas.height != window.innerHeight) {
		canvas.width = window.innerWidth;
		canvas.height = window.innerHeight;
		width = canvas.width;
		height = canvas.height;
	}

	ctx.clearRect(0, 0, width, height);

	ctx.beginPath();
	var grd = ctx.createLinearGradient(0, 0, 0, height);
	grd.addColorStop(0, "#303031");
	grd.addColorStop(1, "#130B17");
	ctx.fillStyle = grd;
	ctx.fillRect(0, 0, width, height);
	ctx.closePath();

	for (var i = 0; i < circles.length; i++) {
		circles[i].draw(.9);
	}

	ctx.beginPath();
	ctx.fillStyle = "rgba(19, 11, 23, " + getOpacityOverlay() + ")";
	ctx.fillRect(0, 0, width, height);
	ctx.closePath();
}

update();
init();
setInterval(update,10);

</script>


</html>